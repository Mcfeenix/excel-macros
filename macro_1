Sub Part1_PrepareData()
    Dim ws As Worksheet
    Dim wsClean As Worksheet
    Dim lastRow As Long
    Dim i As Long
    Dim originalName As String
    
    ' Set the worksheet to the active sheet
    Set ws = ActiveSheet
    originalName = ws.Name
    
    ' Copy the current sheet
    ws.Copy After:=ws
    
    ' Rename the original sheet to "Transactions - raw"
    ' ws.Name = originalName & "Transactions - raw"
    
    ' Set the copied sheet as the clean sheet and rename it
    Set wsClean = ActiveSheet
    wsClean.Name = "Transactions - clean"
    
    ' Set the active sheet to the clean sheet for remaining operations
    Set ws = wsClean
    
    ' Delete the first row
    ws.Rows(1).Delete Shift:=xlUp

    ' Freeze the first row
    ws.Rows(2).Select
    ActiveWindow.FreezePanes = True
    ws.Cells(1, 1).Select ' Return to cell A1
    
    ' Find the last row with data in column A
    lastRow = ws.Cells(ws.Rows.Count, "A").End(xlUp).Row
    
    ' Move values from column E (Gift Amount) based on column F (Gift Type)
    For i = 1 To lastRow
        Dim giftType As String
        Dim amount As Variant
        
        giftType = Trim(UCase(ws.Cells(i, 6).Value)) ' Column F
        amount = ws.Cells(i, 5).Value ' Column E
        
        ' Check if payment type and move to appropriate column
        If InStr(1, giftType, "CHECK", vbTextCompare) > 0 Then
            ws.Cells(i, 8).Value = amount ' Move to column H
            ws.Cells(i, 5).ClearContents ' Clear column E
        ElseIf InStr(1, giftType, "CASH", vbTextCompare) > 0 Then
            ws.Cells(i, 9).Value = amount ' Move to column I
            ws.Cells(i, 5).ClearContents ' Clear column E
        ElseIf InStr(1, giftType, "VISA", vbTextCompare) > 0 Or _
               InStr(1, giftType, "MASTERCARD", vbTextCompare) > 0 Or _
               InStr(1, giftType, "DISCOVER", vbTextCompare) > 0 Or _
               InStr(1, giftType, "CREDIT CARD", vbTextCompare) > 0 Then
            ws.Cells(i, 10).Value = amount ' Move to column J
            ws.Cells(i, 5).ClearContents ' Clear column E
        ElseIf InStr(1, giftType, "ACH", vbTextCompare) > 0 Then
            ws.Cells(i, 11).Value = amount ' Move to column K
            ws.Cells(i, 5).ClearContents ' Clear column E
        ElseIf InStr(1, giftType, "STOCK", vbTextCompare) > 0 Or _
               InStr(1, giftType, "EFT", vbTextCompare) > 0 Then
            ws.Cells(i, 12).Value = amount ' Move to column L
            ws.Cells(i, 5).ClearContents ' Clear column E
        ElseIf InStr(1, giftType, "GIFT IN KIND", vbTextCompare) > 0 Then
            ws.Cells(i, 13).Value = amount ' Move to column M
            ws.Cells(i, 5).ClearContents ' Clear column E
        End If
    Next i
    
    MsgBox "Did all Gift Amounts get moved? If yes, run the next macro. If no, move amounts to the appropriate column before running the next macro.", vbInformation
End Sub



Sub Part2_InsertRows()
    Dim ws As Worksheet
    Dim lastRow As Long
    Dim i As Long
    Dim currentDate As Date
    Dim nextDate As Date
    
    ' Set the worksheet to the active sheet
    Set ws = ActiveSheet

    ' Insert a new column between A and B
    ws.Columns("B:B").Insert Shift:=xlRight
    
    ' Find the last row with data in column C
    lastRow = ws.Cells(ws.Rows.Count, "C").End(xlUp).Row

' !!! Test this
    ' Concatenate columns C and D into column B
    ' If column D is empty don't concat. Just use column C
    For i = 1 To lastRow
        If Trim(ws.Cells(i, 4).Value) = "" Then
            ws.Cells(i, 2).Value = ws.Cells(i, 3).Value
        Else
            ws.Cells(i, 2).Value = ws.Cells(i, 3).Value & ", " & ws.Cells(i, 4).Value
        End If
    Next i
    
    ' Delete columns C, D, E, F, G, H
    ws.Columns("C:H").Delete Shift:=xlLeft
    
        ' Find the last row with data in column A
    lastRow = ws.Cells(ws.Rows.Count, "A").End(xlUp).Row
    
    ' Start from the bottom and work upwards to avoid row number shifts
    For i = lastRow - 1 To 1 Step -1
        ' Check if current cell and next cell both have dates
        If IsDate(ws.Cells(i, 1).Value) And IsDate(ws.Cells(i + 1, 1).Value) Then
            currentDate = ws.Cells(i, 1).Value
            nextDate = ws.Cells(i + 1, 1).Value
            
            ' If the dates are different, insert 3 rows
            If currentDate <> nextDate Then
                ws.Rows(i + 1 & ":" & i + 3).Insert Shift:=xlDown
                
                ' Add "Total" to the first cell and make the entire row bold
                ws.Cells(i + 1, 1).Value = "Total"
                ws.Rows(i + 1).Font.Bold = True
            End If
        End If
    Next i
    
' !!! Test this    
    ' Add "Total" below last date
    lastRow = ws.Cells(ws.Rows.Count, "A").End(xlUp).Row
    ws.Cells(lastRow + 1, 1).Value = "Total"
    ws.Rows(lastRow + 1).Font.Bold = True
    
    ' Change font to Arial Narrow and Black for entire worksheet
    With ws.Cells.Font
        .Name = "Arial Narrow"
        .Color = RGB(0, 0, 0) ' Black
    End With
    
    ' Align left, align top, and turn off text wrapping for entire spreadsheet
    ws.Cells.HorizontalAlignment = xlLeft
    ws.Cells.VerticalAlignment = xlTop
    ws.Cells.WrapText = False
    
    ' Right adjust columns C through H
    ws.Range("C:H").HorizontalAlignment = xlRight
    
    ' Auto-fit all columns
    ws.Cells.EntireColumn.AutoFit
    
' !!! Test this
    ' Apply accounting format to columns C through H
    ws.Columns("C:H").NumberFormat = "_($* #,##0.00_);_($* (#,##0.00);_($* ""-""??_);_(@_)"

    
    
End Sub

Sub Part3()
    

   
    

    
   

' accounting format
End Sub
