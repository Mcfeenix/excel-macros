Sub Part1_PrepareData()
    Dim ws As Worksheet
    Dim wsClean As Worksheet
    Dim lastRow As Long
    Dim i As Long
    Dim originalName As String
    
    ' Set the worksheet to the active sheet
    Set ws = ActiveSheet
    originalName = ws.Name
    
    ' Copy the current sheet
    ws.Copy After:=ws
    
    ' Rename the original sheet to " - raw"
    ws.Name = originalName & " - raw"
    
    ' Set the copied sheet as the clean sheet and rename it
    Set wsClean = ActiveSheet
    wsClean.Name = originalName & " - clean"
    
    ' Set the active sheet to the clean sheet for remaining operations
    Set ws = wsClean
    
    ' Delete the first row
    ws.Rows(1).Delete Shift:=xlUp
    
    ' Insert a new column between A and B
    ws.Columns("B:B").Insert Shift:=xlRight
    
    ' Find the last row with data in column A
    lastRow = ws.Cells(ws.Rows.Count, "A").End(xlUp).Row
    
    ' Concatenate columns C and D into column B
    For i = 1 To lastRow
        ws.Cells(i, 2).Value = ws.Cells(i, 3).Value & ws.Cells(i, 4).Value
    Next i
    
    ' Remove trailing commas from column B
    For i = 1 To lastRow
        If Right(ws.Cells(i, 2).Value, 1) = "," Then
            ws.Cells(i, 2).Value = Left(ws.Cells(i, 2).Value, Len(ws.Cells(i, 2).Value) - 1)
        End If
    Next i
    
    ' Move values from column E based on column F payment type
    For i = 1 To lastRow
        Dim paymentType As String
        Dim amount As Variant
        
        paymentType = Trim(UCase(ws.Cells(i, 6).Value)) ' Column F
        amount = ws.Cells(i, 5).Value ' Column E
        
        ' Check if payment type contains Visa, MasterCard, Discover, or Credit Card
        If InStr(1, paymentType, "VISA", vbTextCompare) > 0 Or _
           InStr(1, paymentType, "MASTERCARD", vbTextCompare) > 0 Or _
           InStr(1, paymentType, "DISCOVER", vbTextCompare) > 0 Or _
           InStr(1, paymentType, "CREDIT CARD", vbTextCompare) > 0 Then
            ws.Cells(i, 7).Value = amount ' Move to column G
            ws.Cells(i, 5).ClearContents ' Clear column E
        ElseIf InStr(1, paymentType, "CHECK", vbTextCompare) > 0 Then
            ws.Cells(i, 8).Value = amount ' Move to column H
            ws.Cells(i, 5).ClearContents ' Clear column E
        ElseIf InStr(1, paymentType, "STOCK", vbTextCompare) > 0 Or _
               InStr(1, paymentType, "EFT", vbTextCompare) > 0 Then
            ws.Cells(i, 9).Value = amount ' Move to column I
            ws.Cells(i, 5).ClearContents ' Clear column E
        ElseIf InStr(1, paymentType, "CASH", vbTextCompare) > 0 Then
            ws.Cells(i, 10).Value = amount ' Move to column J
            ws.Cells(i, 5).ClearContents ' Clear column E
        End If
    Next i
    
    MsgBox "Did all amounts from column E get moved? If yes, run the next macro. If no, move amounts to the appropriate column before running the next macro.", vbInformation
End Sub

Sub Part2_InsertRows()
    Dim ws As Worksheet
    Dim lastRow As Long
    Dim i As Long
    Dim currentDate As Date
    Dim nextDate As Date
    
    ' Set the worksheet to the active sheet
    Set ws = ActiveSheet
    
    ' Find the last row with data in column A
    lastRow = ws.Cells(ws.Rows.Count, "A").End(xlUp).Row
    
    ' Start from the bottom and work upwards to avoid row number shifts
    For i = lastRow - 1 To 1 Step -1
        ' Check if current cell and next cell both have dates
        If IsDate(ws.Cells(i, 1).Value) And IsDate(ws.Cells(i + 1, 1).Value) Then
            currentDate = ws.Cells(i, 1).Value
            nextDate = ws.Cells(i + 1, 1).Value
            
            ' If the dates are different, insert 3 rows
            If currentDate <> nextDate Then
                ws.Rows(i + 1 & ":" & i + 3).Insert Shift:=xlDown
                
                ' Add "Total" in bold to the first cell of the inserted rows
                With ws.Cells(i + 1, 1)
                    .Value = "Total"
                    .Font.Bold = True
                End With
            End If
        End If
    Next i
    
    ' Change font to Arial Narrow and Black for entire worksheet
    With ws.Cells.Font
        .Name = "Arial Narrow"
        .Color = RGB(0, 0, 0) ' Black
    End With
End Sub
